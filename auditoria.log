2025-10-18 15:57:03,082 | INFO | Leyendo archivo archivo.csv
2025-10-18 15:57:03,083 | ERROR | Error en la generación de asientos
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculosv2.py", line 233, in <module>
    asientos = cargar_para_asientos("archivo.csv")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculosv2.py", line 101, in cargar_para_asientos
    df = pd.read_csv(path, dtype=str).fillna("")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 626, in _read
    return parser.read(nrows)
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1923, in read
    ) = self._engine.read(  # type: ignore[attr-defined]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 234, in read
    chunks = self._reader.read_low_memory(nrows)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/parsers.pyx", line 838, in pandas._libs.parsers.TextReader.read_low_memory
  File "pandas/_libs/parsers.pyx", line 905, in pandas._libs.parsers.TextReader._read_rows
  File "pandas/_libs/parsers.pyx", line 874, in pandas._libs.parsers.TextReader._tokenize_rows
  File "pandas/_libs/parsers.pyx", line 891, in pandas._libs.parsers.TextReader._check_tokenize_status
  File "pandas/_libs/parsers.pyx", line 2061, in pandas._libs.parsers.raise_parser_error
pandas.errors.ParserError: Error tokenizing data. C error: Expected 10 fields in line 3, saw 19

2025-10-18 16:06:09,967 | INFO | Leyendo archivo archivo.csv
2025-10-18 16:06:09,990 | ERROR | Error en la generación de asientos
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'numero'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculosv2.py", line 233, in <module>
    asientos = cargar_para_asientos("archivo.csv")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculosv2.py", line 124, in cargar_para_asientos
    df["numero"] = df["numero"].str.zfill(8)
                   ~~^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'numero'
2025-10-18 16:16:35,614 | INFO | Leyendo archivo archivo.csv
2025-10-18 16:16:35,635 | ERROR | Error en la generación de asientos
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'numero'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculosv2.py", line 233, in <module>
    asientos = cargar_para_asientos("archivo.csv")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculosv2.py", line 124, in cargar_para_asientos
    df["numero"] = df["numero"].str.zfill(8)
                   ~~^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'numero'
2025-10-19 17:42:47,399 | INFO | Leyendo archivo archivo.csv
2025-10-19 17:42:47,432 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Número Desde'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 241, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 126, in cargar_para_asientos
    df = _transformar_datos(df)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 79, in _transformar_datos
    df_trans["numero"] = df["Número Desde"]
                         ~~^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Número Desde'
2025-10-19 17:59:57,263 | INFO | Leyendo archivo archivo.csv
2025-10-19 17:59:57,330 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 280, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 165, in cargar_para_asientos
    df = _transformar_datos(df)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 110, in _transformar_datos
    df["IVA 2,5%"].fillna(0).astype(str).map(_normalizar_numero) +
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\series.py", line 4719, in map
    new_values = self._map_values(arg, na_action=na_action)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 42, in _normalizar_numero
    col.astype(str)
    ^^^^^^^^^^
AttributeError: 'str' object has no attribute 'astype'
2025-10-19 18:01:05,058 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:01:05,112 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 280, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 165, in cargar_para_asientos
    df = _transformar_datos(df)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 110, in _transformar_datos
    _normalizar_numero(df["IVA 2,5%"].fillna("0")) +
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 46, in _normalizar_numero
    .astype(float)
     ^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\generic.py", line 6665, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\internals\managers.py", line 449, in astype
    return self.apply(
           ^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\internals\managers.py", line 363, in apply
    applied = getattr(b, f)(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\internals\blocks.py", line 784, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\dtypes\astype.py", line 237, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\dtypes\astype.py", line 182, in astype_array
    values = _astype_nansafe(values, dtype, copy=copy)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\dtypes\astype.py", line 133, in _astype_nansafe
    return arr.astype(dtype, copy=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: ''
2025-10-19 18:01:37,349 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:01:37,416 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 281, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 166, in cargar_para_asientos
    df = _transformar_datos(df)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 132, in _transformar_datos
    df_trans["cod_tributo"] = df.apply(get_cod_tributo, axis=1)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\frame.py", line 10401, in apply
    return op.apply().__finalize__(self, method="apply")
           ^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 120, in get_cod_tributo
    if _normalizar_numero(row["IVA 27%"]) > 0:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 42, in _normalizar_numero
    col.astype(str)
    ^^^^^^^^^^
AttributeError: 'str' object has no attribute 'astype'
2025-10-19 18:02:10,028 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:02:10,075 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 288, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 173, in cargar_para_asientos
    df = _transformar_datos(df)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 114, in _transformar_datos
    df_trans["monto_neto"] = _normalizar_numero(df["Imp. Neto Gravado Total"].fillna("0"))
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 41, in _normalizar_numero
    if pd.isna(valor) or valor == "":
       ^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\generic.py", line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-10-19 18:02:42,504 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:02:42,552 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 295, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 180, in cargar_para_asientos
    df = _transformar_datos(df)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 114, in _transformar_datos
    df_trans["monto_neto"] = _normalizar_numero(df["Imp. Neto Gravado Total"].fillna("0"))
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 41, in _normalizar_numero
    if pd.isna(valor) or valor == "":
       ^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\generic.py", line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-10-19 18:03:28,978 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:03:29,030 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 291, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 176, in cargar_para_asientos
    df = _transformar_datos(df)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 114, in _transformar_datos
    df_trans["monto_neto"] = _normalizar_numero(df["Imp. Neto Gravado Total"].fillna("0"))
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 41, in _normalizar_numero
    if pd.isna(valor) or valor == "":
       ^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\generic.py", line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-10-19 18:04:30,471 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:04:30,521 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 301, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 177, in cargar_para_asientos
    df = _transformar_datos(df)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 115, in _transformar_datos
    df_trans["monto_neto"] = _normalizar_numero(df["Imp. Neto Gravado Total"].fillna("0"))
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 41, in _normalizar_numero
    if pd.isna(valor) or valor == "":
       ^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\generic.py", line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-10-19 18:15:22,658 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:15:22,709 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 310, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 186, in cargar_para_asientos
    df = _transformar_datos(df)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 124, in _transformar_datos
    df_trans["monto_neto"] = _normalizar_numero(df["Imp. Neto Gravado Total"].fillna("0"))
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 41, in _normalizar_numero
    if pd.isna(valor) or valor == "":
       ^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\generic.py", line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-10-19 18:16:09,640 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:16:09,697 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 310, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 186, in cargar_para_asientos
    df = _transformar_datos(df)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 124, in _transformar_datos
    df_trans["monto_neto"] = _normalizar_numero(df["Imp. Neto Gravado Total"].fillna("0"))
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 41, in _normalizar_numero
    if pd.isna(valor) or valor == "":
       ^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\venv\Lib\site-packages\pandas\core\generic.py", line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-10-19 18:16:39,665 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:16:39,749 | INFO | Registros tras validar CAE: 45
2025-10-19 18:16:39,771 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 310, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 262, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: 489,241,503,268,824.00
2025-10-19 18:17:17,890 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:17:17,949 | INFO | Registros tras validar CAE: 45
2025-10-19 18:17:18,054 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 328, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 280, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: 489,241,503,268,824.00
2025-10-19 18:18:29,918 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:18:29,996 | INFO | Registros tras validar CAE: 45
2025-10-19 18:18:30,033 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 318, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 270, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: 3,416,405.55
2025-10-19 18:19:23,733 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:19:23,798 | INFO | Registros tras validar CAE: 45
2025-10-19 18:19:23,835 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 343, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 295, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: 3,416,405.55
2025-10-19 18:22:52,781 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:22:52,847 | INFO | Registros tras validar CAE: 45
2025-10-19 18:22:52,887 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 359, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 311, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: 3,416,405.55
2025-10-19 18:23:29,542 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:23:29,621 | INFO | Registros tras validar CAE: 45
2025-10-19 18:23:29,679 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 378, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 330, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: -2,297,631.60
2025-10-19 18:25:34,298 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:25:34,375 | INFO | Registros tras validar CAE: 45
2025-10-19 18:25:34,433 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 385, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 337, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: -2,297,631.60
2025-10-19 18:26:45,509 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:26:45,587 | INFO | Registros tras validar CAE: 45
2025-10-19 18:26:45,648 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 402, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 354, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: 287,350,554,807,288.00
2025-10-19 18:27:41,347 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:27:41,424 | INFO | Registros tras validar CAE: 45
2025-10-19 18:27:41,486 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 391, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 343, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: 287,350,554,807,288.00
2025-10-19 18:28:15,096 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:28:15,174 | INFO | Registros tras validar CAE: 45
2025-10-19 18:28:15,230 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 404, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 356, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: -178,995.26
2025-10-19 18:29:43,235 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:29:43,317 | INFO | Registros tras validar CAE: 45
2025-10-19 18:29:43,380 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 404, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 356, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: -178,995.26
2025-10-19 18:31:18,195 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:31:18,275 | INFO | Registros tras validar CAE: 45
2025-10-19 18:31:18,350 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 414, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 366, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: 178,995.26
2025-10-19 18:32:49,282 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:32:49,393 | INFO | Registros tras validar CAE: 45
2025-10-19 18:32:49,475 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 417, in <module>
    asientos = cargar_para_asientos(archivo_csv)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 369, in cargar_para_asientos
    raise RuntimeError(f"El asiento no cuadra. Diferencia: {diferencia:,.2f}")
RuntimeError: El asiento no cuadra. Diferencia: -178,995.26
2025-10-19 18:37:26,671 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:37:26,787 | INFO | Registros tras validar CAE: 45
2025-10-19 18:37:26,868 | INFO | Asientos generados: 208
2025-10-19 18:42:59,566 | INFO | Leyendo archivo archivo.csv
2025-10-19 18:42:59,672 | INFO | Registros tras validar CAE: 45
2025-10-19 18:42:59,742 | INFO | Asientos generados: 208
2025-10-19 19:22:12,358 | INFO | Leyendo archivo archivo.csv
2025-10-19 19:22:12,460 | INFO | Registros tras validar CAE: 45
2025-10-19 19:22:12,529 | INFO | Asientos generados: 208
2025-10-19 21:34:02,444 | INFO | Leyendo archivo archivo.csv
2025-10-19 21:34:02,510 | INFO | Registros tras validar CAE: 45
2025-10-19 21:34:02,546 | INFO | Asientos generados: 208
2025-10-19 21:34:02,561 | ERROR | Error en la ejecución del script
Traceback (most recent call last):
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\calculos_rt54_rg4115.py", line 436, in <module>
    from exportar import exportar_a_excel, exportar_a_pdf
  File "C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\exportar.py", line 9, in <module>
    from reportlab.lib import colors
ModuleNotFoundError: No module named 'reportlab'
2025-10-19 22:19:50,632 | INFO | Leyendo archivo archivo.csv
2025-10-19 22:19:50,681 | INFO | Registros tras validar CAE: 45
2025-10-19 22:19:50,744 | INFO | Asientos generados: 208
2025-10-19 22:28:33,631 | INFO | Leyendo archivo archivo.csv
2025-10-19 22:28:33,679 | INFO | Registros tras validar CAE: 45
2025-10-19 22:28:33,721 | INFO | Asientos generados: 208
2025-10-20 01:29:10,137 | INFO | Leyendo archivo archivo.csv
2025-10-20 01:29:10,258 | INFO | Registros tras validar CAE: 45
2025-10-20 01:29:10,335 | INFO | Asientos generados: 208
2025-10-20 16:28:14,038 | INFO | Leyendo archivo archivo.csv
2025-10-20 16:28:14,097 | INFO | Registros tras validar CAE: 45
2025-10-20 16:28:14,120 | INFO | Asientos generados: 208
2025-10-20 16:29:02,270 | INFO | Leyendo archivo archivo.csv
2025-10-20 16:29:02,319 | INFO | Registros tras validar CAE: 45
2025-10-20 16:29:02,341 | INFO | Asientos generados: 208
2025-10-20 16:56:23,702 | INFO | Assets path configured: C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\assets
2025-10-20 16:56:23,703 | INFO | Starting up TCP server on localhost:64600
2025-10-20 16:56:23,712 | INFO | Flet app has started...
2025-10-20 16:56:23,712 | INFO | App URL: tcp://localhost:64600
2025-10-20 16:56:23,712 | INFO | Starting Flet View app...
2025-10-20 16:56:23,714 | INFO | Downloading Flet v0.24.1 to C:\Users\Javier Parra\AppData\Local\Temp\flet-windows.zip
2025-10-20 16:56:28,113 | INFO | Extracting flet.exe from archive to C:\Users\Javier Parra\.flet\bin\flet-0.24.1
2025-10-20 16:56:29,584 | INFO | App session started
2025-10-20 17:08:51,369 | INFO | Assets path configured: C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\assets
2025-10-20 17:08:51,370 | INFO | Starting up TCP server on localhost:63579
2025-10-20 17:08:51,376 | INFO | Flet app has started...
2025-10-20 17:08:51,376 | INFO | App URL: tcp://localhost:63579
2025-10-20 17:08:51,376 | INFO | Starting Flet View app...
2025-10-20 17:08:51,572 | INFO | App session started
2025-10-20 17:08:58,967 | INFO | Leyendo archivo archivo.csv
2025-10-20 17:08:59,027 | INFO | Registros tras validar CAE: 45
2025-10-20 17:08:59,057 | INFO | Asientos generados: 208
2025-10-21 15:03:30,902 | INFO | Assets path configured: C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\assets
2025-10-21 15:03:30,904 | INFO | Starting up TCP server on localhost:61274
2025-10-21 15:03:30,911 | INFO | Flet app has started...
2025-10-21 15:03:30,911 | INFO | App URL: tcp://localhost:61274
2025-10-21 15:03:30,911 | INFO | Starting Flet View app...
2025-10-21 15:03:31,475 | INFO | App session started
2025-10-21 15:03:49,688 | INFO | Leyendo archivo archivo.csv
2025-10-21 15:03:49,855 | INFO | Registros tras validar CAE: 45
2025-10-21 15:03:49,902 | INFO | Asientos generados: 208
2025-10-24 15:39:06,831 | INFO | Assets path configured: C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\assets
2025-10-24 15:39:06,833 | INFO | Starting up TCP server on localhost:60034
2025-10-24 15:39:06,841 | INFO | Flet app has started...
2025-10-24 15:39:06,841 | INFO | App URL: tcp://localhost:60034
2025-10-24 15:39:06,841 | INFO | Starting Flet View app...
2025-10-24 15:39:07,380 | INFO | App session started
2025-10-24 15:39:16,184 | INFO | Leyendo archivo archivo.csv
2025-10-24 15:39:16,265 | INFO | Registros tras validar CAE: 45
2025-10-24 15:39:16,297 | INFO | Asientos generados: 208
2025-10-24 15:42:24,322 | INFO | Assets path configured: C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\assets
2025-10-24 15:42:24,323 | INFO | Starting up TCP server on localhost:57087
2025-10-24 15:42:24,329 | INFO | Flet app has started...
2025-10-24 15:42:24,329 | INFO | App URL: tcp://localhost:57087
2025-10-24 15:42:24,329 | INFO | Starting Flet View app...
2025-10-24 15:42:24,504 | INFO | App session started
2025-10-24 15:42:31,296 | INFO | Leyendo archivo archivo.csv
2025-10-24 15:42:31,347 | INFO | Registros tras validar CAE: 45
2025-10-24 15:42:31,372 | INFO | Asientos generados: 208
2025-10-24 16:19:35,586 | INFO | Assets path configured: C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\assets
2025-10-24 16:19:35,589 | INFO | Starting up TCP server on localhost:59416
2025-10-24 16:19:35,601 | INFO | Flet app has started...
2025-10-24 16:19:35,602 | INFO | App URL: tcp://localhost:59416
2025-10-24 16:19:35,602 | INFO | Starting Flet View app...
2025-10-24 16:19:35,961 | INFO | App session started
2025-10-24 16:27:45,935 | INFO | Leyendo archivo archivo.csv
2025-10-24 16:27:46,079 | INFO | Registros tras validar CAE: 45
2025-10-24 16:27:46,142 | INFO | Asientos generados: 208
2025-10-24 17:06:37,914 | INFO | Assets path configured: C:\Users\Javier Parra\Documents\mcp_docker\contaAliss\assets
2025-10-24 17:06:37,915 | INFO | Starting up TCP server on localhost:56475
2025-10-24 17:06:37,926 | INFO | Flet app has started...
2025-10-24 17:06:37,927 | INFO | App URL: tcp://localhost:56475
2025-10-24 17:06:37,927 | INFO | Starting Flet View app...
2025-10-24 17:06:38,210 | INFO | App session started
2025-10-24 17:29:54,155 | INFO | Leyendo archivo archivo.csv
2025-10-24 17:29:54,237 | INFO | Registros tras validar CAE: 45
2025-10-24 17:29:54,277 | INFO | Asientos generados: 208
